<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Ø§Ù„Ø¹Ù…Ø§Ù„ - Wassal Khedma</title>
  <style>
    body {
      font-family: 'Segoe UI', sans-serif;
      background: linear-gradient(to right, #E0EAFC, #CFDEF3);
      margin: 0;
      padding: 0;
    }
    /* Navbar */
    nav {
      background-color: #2c3e50;
      padding: 10px 20px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      flex-wrap: wrap;
    }
    nav img {
      height: 40px;
      border-radius: 50%;
      user-select: none;
    }
    .nav-links {
      display: flex;
      align-items: center;
      gap: 15px;
    }
    .nav-links a {
      color: white;
      text-decoration: none;
      font-weight: bold;
      transition: color 0.3s ease;
    }
    .nav-links a:hover {
      color: #1abc9c;
    }
    h2 {
      text-align: center;
      margin: 30px 0 10px;
      color: #2c3e50;
    }
    .filters {
      text-align: center;
      margin-bottom: 20px;
    }
    .filters select {
      padding: 10px;
      margin: 0 10px;
      border-radius: 6px;
      border: 1px solid #ccc;
      font-size: 15px;
    }
    .worker-list {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap: 20px;
      padding: 20px;
      max-width: 1200px;
      margin: auto;
    }
    .worker-card {
      background: white;
      padding: 20px;
      border-radius: 10px;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
      transition: transform 0.3s ease;
      text-align: center;
    }
    .worker-card:hover {
      transform: scale(1.03);
    }
    .worker-card img {
      width: 80px;
      height: 80px;
      border-radius: 50%;
      object-fit: cover;
      margin-bottom: 10px;
      user-select: none;
    }
    .worker-card h3 {
      margin: 10px 0 5px;
      color: #2980b9;
    }
    .worker-card p {
      margin: 5px 0;
      font-size: 14px;
      color: #555;
    }
    .no-data {
      text-align: center;
      font-size: 16px;
      color: gray;
      margin-top: 30px;
    }
  </style>
</head>
<body>

  <!-- Navbar -->
  <nav>
    <img src="images/wassal.jfif" alt="Wassal Khedma Logo" />
    <div class="nav-links" id="navLinks">
      <!-- Ø§Ù„Ø±ÙˆØ§Ø¨Ø· Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠØ© Ø­Ø³Ø¨ Ø­Ø§Ù„Ø© ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ -->
    </div>
  </nav>

  <h2>Ø§Ù„Ø¹Ù…Ø§Ù„ Ø§Ù„Ù…ØªØ§Ø­ÙŠÙ† Ø­Ø§Ù„ÙŠÙ‹Ø§</h2>

  <!-- ÙÙ„Ø§ØªØ± Ø§Ù„Ø¨Ø­Ø« -->
  <div class="filters">
    <select id="filterService" aria-label="Ø§Ø®ØªÙŠØ§Ø± Ù†ÙˆØ¹ Ø§Ù„Ø®Ø¯Ù…Ø©">
      <option value="">Ù†ÙˆØ¹ Ø§Ù„Ø®Ø¯Ù…Ø©</option>
      <option>Ø³Ø¨Ø§ÙƒØ©</option>
      <option>ÙƒÙ‡Ø±Ø¨Ø§Ø¡</option>
      <option>Ù†Ø¬Ø§Ø±Ø©</option>
      <option>Ù…Ø­Ø§Ø±Ø© ÙˆØ¯Ù‡Ø§Ù†</option>
      <option>Ø£Ø¹Ù…Ø§Ù„ Ø§Ù„ØªÙƒÙŠÙŠÙ ÙˆØ§Ù„ØªØ¨Ø±ÙŠØ¯</option>
      <option>Ø£Ù†Ø¸Ù…Ø© Ø§Ù„Ø£Ù…Ù† ÙˆØ§Ù„Ù…Ø±Ø§Ù‚Ø¨Ø©</option>
      <option>Ø§Ù„Ø²Ø¬Ø§Ø¬ ÙˆØ§Ù„Ø£Ù„Ù…Ù†ÙŠÙˆÙ…</option>
      <option>Ø§Ù„Ø­Ø¯Ø§Ø¯Ø© ÙˆØ§Ù„Ø£Ù„ÙˆÙ…ÙŠØªØ§Ù„</option>
      <option>Ø§Ù„Ù†Ø¸Ø§ÙØ© ÙˆØ§Ù„ØªØ¹Ù‚ÙŠÙ…</option>
    </select>

    <select id="filterStatus" aria-label="Ø§Ø®ØªÙŠØ§Ø± Ø­Ø§Ù„Ø© Ø§Ù„Ø¹Ø§Ù…Ù„">
      <option value="">Ø§Ù„Ø­Ø§Ù„Ø©</option>
      <option value="Ù…ØªØ§Ø­">Ù…ØªØ§Ø­</option>
      <option value="Ù…Ø´ØºÙˆÙ„">Ù…Ø´ØºÙˆÙ„</option>
    </select>
  </div>

  <!-- Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¹Ù…Ø§Ù„ -->
  <div class="worker-list" id="workerList"></div>
  <p class="no-data" id="noData" style="display: none;">Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø¹Ù…Ø§Ù„ Ø¨Ù‡Ø°Ù‡ Ø§Ù„Ù…ÙˆØ§ØµÙØ§Øª Ø­Ø§Ù„ÙŠÙ‹Ø§.</p>

  <script>
    // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
    const loggedUser = JSON.parse(localStorage.getItem("loggedUser"));
    const isAdmin = localStorage.getItem("isAdmin") === "true";
    const navLinks = document.getElementById("navLinks");

    function buildNavLinks() {
      navLinks.innerHTML = "";

      navLinks.insertAdjacentHTML("beforeend", `<a href="index.html">Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</a>`);
      navLinks.insertAdjacentHTML("beforeend", `<a href="about.html">Ø¹Ù† Wassal Khedma</a>`);
      navLinks.insertAdjacentHTML("beforeend", `<a href="workers.html">Ø§Ù„Ø¹Ù…Ø§Ù„</a>`);
      navLinks.insertAdjacentHTML("beforeend", `<a href="request.html">Ø·Ù„Ø¨ Ø®Ø¯Ù…Ø©</a>`);
      navLinks.insertAdjacentHTML("beforeend", `<a href="contact.html">ØªÙˆØ§ØµÙ„ Ù…Ø¹Ù†Ø§</a>`);

      if (loggedUser) {
        // Ù„Ùˆ Ø§Ù„Ø§Ø¯Ù…Ù† ÙŠÙØªØ­ Ø¯Ø§Ø´Ø¨ÙˆØ±Ø¯ Ø§Ù„Ø§Ø¯Ù…Ù†
        if (isAdmin) {
          navLinks.insertAdjacentHTML("beforeend", `<a href="dashboard.html">Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…</a>`);
        }
        navLinks.insertAdjacentHTML("beforeend", `<a href="#" id="logoutLink">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬</a>`);
      } else {
        navLinks.insertAdjacentHTML("beforeend", `<a href="login.html">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</a>`);
      }
    }

    buildNavLinks();

    // ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬
    document.addEventListener("click", (e) => {
      if (e.target.id === "logoutLink") {
        e.preventDefault();
        localStorage.removeItem("loggedUser");
        localStorage.removeItem("isAdmin");
        alert("âœ… ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬ Ø¨Ù†Ø¬Ø§Ø­");
        window.location.href = "index.html";
      }
    });

    // Ø¬Ù„Ø¨ ÙƒÙ„ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† Ù…Ù† localStorage
    const allUsers = JSON.parse(localStorage.getItem("users")) || [];
    const workers = allUsers.filter(u => u.role === "worker");

    const workerList = document.getElementById("workerList");
    const filterService = document.getElementById("filterService");
    const filterStatus = document.getElementById("filterStatus");
    const noData = document.getElementById("noData");

    function displayWorkers(list) {
      workerList.innerHTML = "";
      if (list.length === 0) {
        noData.style.display = "block";
        return;
      }
      noData.style.display = "none";

      list.forEach(worker => {
        const phoneFormatted = worker.phone && !worker.phone.startsWith("+20") ? `+20 ${worker.phone}` : worker.phone || "";
        const card = document.createElement("div");
        card.className = "worker-card";
        card.innerHTML = `
          <img src="${worker.avatar || 'https://cdn-icons-png.flaticon.com/512/1995/1995574.png'}" alt="ØµÙˆØ±Ø© Ø§Ù„Ø¹Ø§Ù…Ù„">
          <h3>${worker.name || "ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ"}</h3>
          <p>ğŸ“± ${phoneFormatted}</p>
          <p>âœ‰ï¸ ${worker.email || "ØºÙŠØ± Ù…ØªÙˆÙØ±"}</p>
          <p>ğŸ”§ Ø§Ù„Ø®Ø¯Ù…Ø©: ${worker.service || "ØºÙŠØ± Ù…Ø­Ø¯Ø¯"}</p>
          <p>ğŸ“ Ø§Ù„Ù…Ù†Ø·Ù‚Ø©: ${worker.location || "ØºÙŠØ± Ù…Ø­Ø¯Ø¯Ø©"}</p>
          <p>ğŸ“Š Ø§Ù„Ø®Ø¨Ø±Ø©: ${worker.experience || "ØºÙŠØ± Ù…Ø­Ø¯Ø¯Ø©"}</p>
          <p>â±ï¸ Ø§Ù„Ø­Ø§Ù„Ø©: <strong>${worker.availability || "Ù…ØªØ§Ø­"}</strong></p>
        `;
        workerList.appendChild(card);
      });
    }

    function applyFilters() {
      const selectedService = filterService.value;
      const selectedStatus = filterStatus.value;

      const filtered = workers.filter(worker => {
        const matchService = selectedService ? worker.service === selectedService : true;
        const matchStatus = selectedStatus ? worker.availability === selectedStatus : true;
        return matchService && matchStatus;
      });

      displayWorkers(filtered);
    }

    filterService.addEventListener("change", applyFilters);
    filterStatus.addEventListener("change", applyFilters);

    // Ø¹Ø±Ø¶ Ø£ÙˆÙ„ÙŠ
    displayWorkers(workers);

  </script>

</body>
</html>
